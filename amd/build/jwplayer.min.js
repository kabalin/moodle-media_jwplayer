define ("media_jwplayer/jwplayer",["jwplayer","jquery","core/ajax","core/log","module","core/config","core/str"],function(a,b,c,d,e,f,g){var h={context:null,eventMap:{started:"firstFrame",paused:"pause",seeked:"seek",resumed:"play",completed:"complete"},reqEventMap:{},init:function init(c,f,g){h.context=g;if(!b("#"+f).length){throw new Error("The target element for player setup (#"+f+") is missing.")}if(e.config().licensekey){a.key=e.config().licensekey}var i=a(f);i.setup(c.setupdata);if(c.showdownloadbtn){h.addDownloadButton(i)}c.events.forEach(function(a){if("undefined"==typeof h.getEventName(a)){throw new Error("Event tracking for '"+a+"' has no JWPlayer API event mapping.")}h.reqEventMap[h.getEventName(a)]=a;i.on(h.getEventName(a),h.logEvent)});if(c.logerrors){i.on("error",h.logError)}i.on("error",function(a){d.error("media_jwplayer error: "+a.message)});i.on("setupError",function(a){d.error("media_jwplayer setup error: "+a.message)})},addDownloadButton:function addDownloadButton(a){g.get_string("downloadbuttontitle","media_jwplayer").done(function(b){var c=f.wwwroot+"/media/player/jwplayer/pix/download.svg";a.addButton(c,b,function(){window.open(a.getPlaylistItem().file+"?forcedownload=true")},"download")}).fail(d.error)},getEventName:function getEventName(a){return h.eventMap[a]},logEvent:function logEvent(a){if("play"===a.type&&"interaction"!==a.playReason){return}if("pause"===a.type&&"interaction"!==a.pauseReason){return}var e={context:h.context,event:h.reqEventMap[a.type],title:this.getPlaylistItem().file,position:parseInt(this.getPosition())};if("undefined"!=typeof this.getPlaylistItem().title){e.title=this.getPlaylistItem().title}if("seek"===a.type){e.offset=parseInt(a.offset)}b.when(c.call([{methodname:"media_jwplayer_playback_event",args:e}])[0]).fail(d.error)},logError:function logError(a){var e={context:h.context,title:this.getPlaylistItem().file,position:parseInt(this.getPosition()),code:a.code,message:a.message};if("undefined"!=typeof this.getPlaylistItem().title){e.title=this.getPlaylistItem().title}b.when(c.call([{methodname:"media_jwplayer_playback_failed",args:e}])[0]).fail(d.error)}};return{setupPlayer:h.init}});
//# sourceMappingURL=jwplayer.min.js.map
